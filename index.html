<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠ ÙˆØ§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</title>
    <style>
        :root { --bg: #f0f2f5; --panel: #ffffff; --primary: #1a2a3a; --accent: #3498db; --gold: #f1c40f; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar { width: 280px; background: var(--primary); color: white; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; border-left: 1px solid #2c3e50; }
        .sidebar h2 { font-size: 1.1rem; border-bottom: 2px solid var(--accent); padding-bottom: 10px; margin-top: 25px; color: var(--accent); }
        .season-link { padding: 12px; margin: 5px 0; background: #2c3e50; border-radius: 8px; cursor: pointer; transition: 0.3s; text-align: center; font-size: 0.95em; }
        .season-link:hover { background: var(--accent); }
        .active-season { background: var(--accent); font-weight: bold; box-shadow: 0 0 10px rgba(0,0,0,0.3); }

        /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± */
        .trophy-table { width: 100%; margin-top: 10px; border-collapse: collapse; background: #243444; border-radius: 8px; overflow: hidden; }
        .trophy-table th, .trophy-table td { padding: 10px; text-align: center; border-bottom: 1px solid #2c3e50; }
        .trophy-table th { background: #131e29; font-size: 0.8em; color: #bdc3c7; }
        .gold-text { color: var(--gold); font-weight: bold; font-size: 1.1em; }

        /* Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-content { flex: 1; padding: 25px; overflow-y: auto; }
        .container { max-width: 850px; margin: auto; background: var(--panel); padding: 30px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        h1 { margin: 0; color: var(--primary); font-size: 1.5rem; }

        table { width: 100%; border-collapse: collapse; margin-bottom: 25px; }
        th, td { border: 1px solid #eee; padding: 12px; text-align: center; }
        th { background: #fdfdfd; color: #7f8c8d; font-weight: 600; }
        .rank-1 { background-color: #fff9e6; font-weight: bold; }

        .match-card { background: #fbfcfc; border: 1px solid #ebedef; padding: 12px; margin: 10px 0; border-radius: 10px; display: flex; align-items: center; justify-content: space-around; gap: 10px; }
        .score-input { width: 50px; text-align: center; font-weight: bold; font-size: 1.1em; padding: 6px; border: 1px solid #d5dbdb; border-radius: 6px; }
        
        .btn { border: none; padding: 10px 18px; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-success { background: #2ecc71; color: white; }
        .btn-success:hover { background: #27ae60; }
        .btn-new { background: var(--gold); color: #000; width: 100%; margin-top: 20px; font-size: 1em; }
        
        .badge { padding: 3px 8px; border-radius: 4px; font-size: 0.75em; background: #f0f3f4; color: #7f8c8d; }
        .hidden { display: none; }
        .champion-banner { background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%); color: white; padding: 20px; border-radius: 10px; margin-top: 25px; text-align: center; animation: glow 2s infinite alternate; }
        @keyframes glow { from { box-shadow: 0 0 5px #f1c40f; } to { box-shadow: 0 0 20px #f1c40f; } }
    </style>
</head>
<body>

<div class="sidebar">
    <div style="text-align: center; padding: 10px 0;">
        <span style="font-size: 3rem;">ğŸ†</span>
    </div>

    <h2>ğŸ–ï¸ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ (Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ)</h2>
    <table class="trophy-table">
        <thead>
            <tr>
                <th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th>
                <th>Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</th>
            </tr>
        </thead>
        <tbody id="trophyBody">
            </tbody>
    </table>

    <h2>ğŸ“‚ Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ù…ÙˆØ§Ø³Ù…</h2>
    <div id="seasonsList"></div>
    <button class="btn btn-new" id="newSeasonBtn" onclick="createNewSeason()" style="display:none;">â• Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<div class="main-content">
    <div class="container">
        <header>
            <h1 id="seasonTitle">Ø§Ù„Ù…ÙˆØ³Ù… 1</h1>
            <div id="statusBadge" class="badge" style="background: #e8f8f5; color: #1abc9c; font-size: 1em; padding: 5px 15px;">Ù…ÙˆØ³Ù… Ù†Ø´Ø·</div>
        </header>
        
        <section id="tableSection">
            <h3>ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ±ØªÙŠØ¨</h3>
            <table id="leagueTable">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ù…Ø±ÙƒØ²</th>
                        <th>Ø§Ù„ÙØ±ÙŠÙ‚</th>
                        <th>Ù„Ø¹Ø¨</th>
                        <th>Ù†Ù‚Ø§Ø·</th>
                        <th>+/-</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </section>

        <section id="matchesSection">
            <h3>âš½ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠ</h3>
            <div id="matchesList"></div>
        </section>

        <div id="playoffs" class="hidden">
            <h3 style="color:#e67e22; border-top: 1px solid #eee; padding-top: 20px;">ğŸ† Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø°Ù‡Ø¨ÙŠ (Ø§Ù„Ø¥Ù‚ØµØ§Ø¦ÙŠØ§Øª)</h3>
            <div id="semiMatch"></div>
            <div id="finalMatch" style="margin-top:15px"></div>
        </div>

        <div id="championAnnounce" class="champion-banner hidden">
            <h2 style="margin:0; font-size: 1.8rem;">ğŸ‘‘ Ø¨Ø·Ù„ Ø§Ù„Ù…ÙˆØ³Ù…: <span id="winnerName"></span> ğŸ‘‘</h2>
            <p style="margin: 5px 0 0 0; opacity: 0.9;">ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ù„Ø³Ø¬Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ</p>
        </div>
    </div>
</div>

<script>
    let seasonsData = {};
    let trophies = {"Ø£Ø­Ù…Ø¯": 0, "Ù…Ø´Ø¹Ù„": 0, "ÙÙŠØµÙ„": 0};
    let currentSeasonId = 1;
    let viewingSeasonId = 1;
    const teamNames = ["Ø£Ø­Ù…Ø¯", "Ù…Ø´Ø¹Ù„", "ÙÙŠØµÙ„"];

    function init() {
        seasonsData[1] = createNewSeasonObject(1);
        updateTrophyTable();
        renderSidebar();
        loadSeason(1);
    }

    function createNewSeasonObject(id) {
        return {
            id: id,
            leagueMatches: [
                {h: "Ø£Ø­Ù…Ø¯", a: "Ù…Ø´Ø¹Ù„", sh: null, sa: null, time: "-"},
                {h: "Ù…Ø´Ø¹Ù„", a: "ÙÙŠØµÙ„", sh: null, sa: null, time: "-"},
                {h: "ÙÙŠØµÙ„", a: "Ø£Ø­Ù…Ø¯", sh: null, sa: null, time: "-"},
                {h: "Ù…Ø´Ø¹Ù„", a: "Ø£Ø­Ù…Ø¯", sh: null, sa: null, time: "-"},
                {h: "ÙÙŠØµÙ„", a: "Ù…Ø´Ø¹Ù„", sh: null, sa: null, time: "-"},
                {h: "Ø£Ø­Ù…Ø¯", a: "ÙÙŠØµÙ„", sh: null, sa: null, time: "-"}
            ],
            semiFinal: {h: "", a: "", sh: null, sa: null, time: "-"},
            final: {h: "", a: "", sh: null, sa: null, time: "-"},
            isFinished: false,
            winner: ""
        };
    }

    function updateTrophyTable() {
        const tbody = document.getElementById("trophyBody");
        // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª
        const sortedTrophies = Object.entries(trophies).sort((a,b) => b[1] - a[1]);
        
        tbody.innerHTML = "";
        sortedTrophies.forEach(([name, count]) => {
            tbody.innerHTML += `
                <tr>
                    <td style="text-align:right; padding-right:20px;">${name}</td>
                    <td class="gold-text">${count} ğŸ†</td>
                </tr>
            `;
        });
    }

    function renderSidebar() {
        const list = document.getElementById("seasonsList");
        list.innerHTML = "";
        Object.keys(seasonsData).sort((a,b) => b-a).forEach(id => {
            const btn = document.createElement("div");
            btn.className = `season-link ${id == viewingSeasonId ? 'active-season' : ''}`;
            btn.innerHTML = `Ø§Ù„Ù…ÙˆØ³Ù… ${id} ${seasonsData[id].isFinished ? 'ğŸ' : 'âš½'}`;
            btn.onclick = () => loadSeason(parseInt(id));
            list.appendChild(btn);
        });
    }

    function loadSeason(id) {
        viewingSeasonId = id;
        const data = seasonsData[id];
        document.getElementById("seasonTitle").innerText = `Ø§Ù„Ù…ÙˆØ³Ù… ${id}`;
        document.getElementById("statusBadge").innerText = data.isFinished ? "Ù…ÙˆØ³Ù… Ù…Ù†ØªÙ‡ÙŠ" : "Ù…ÙˆØ³Ù… Ù†Ø´Ø·";
        document.getElementById("statusBadge").style.background = data.isFinished ? "#fdf2e9" : "#e8f8f5";
        document.getElementById("statusBadge").style.color = data.isFinished ? "#e67e22" : "#1abc9c";
        
        renderSidebar();
        updateUI(data);
    }

    function updateMatch(type, i) {
        const data = seasonsData[viewingSeasonId];
        if (data.isFinished) return; // Ù…Ù†Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ Ù…ÙˆØ³Ù… Ù…Ù†ØªÙ‡ÙŠ

        const sh = document.getElementById(`${type}-h-${i}`).value;
        const sa = document.getElementById(`${type}-a-${i}`).value;
        if (sh === "" || sa === "") return;

        const time = new Date().toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'});

        if (type === 'L') { data.leagueMatches[i].sh = parseInt(sh); data.leagueMatches[i].sa = parseInt(sa); data.leagueMatches[i].time = time; }
        else if (type === 'S') { data.semiFinal.sh = parseInt(sh); data.semiFinal.sa = parseInt(sa); data.semiFinal.time = time; }
        else if (type === 'F') { 
            data.final.sh = parseInt(sh); data.final.sa = parseInt(sa); data.final.time = time;
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨Ø·Ù„ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ ÙÙˆØ± Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
            if (data.final.sh !== null && !data.isFinished) {
                data.winner = data.final.sh > data.final.sa ? data.final.h : data.final.a;
                trophies[data.winner]++;
                data.isFinished = true;
                updateTrophyTable();
            }
        }
        updateUI(data);
    }

    function updateUI(data) {
        let stats = {};
        teamNames.forEach(t => stats[t] = {p:0, pts:0, gd:0});
        let played = 0;
        data.leagueMatches.forEach(m => {
            if (m.sh !== null) {
                played++;
                stats[m.h].p++; stats[m.a].p++;
                stats[m.h].gd += (m.sh - m.sa); stats[m.a].gd += (m.sa - m.sh);
                if (m.sh > m.sa) stats[m.h].pts += 3; else if (m.sh < m.sa) stats[m.a].pts += 3; else { stats[m.h].pts+=1; stats[m.a].pts+=1; }
            }
        });

        const sorted = [...teamNames].sort((a,b) => stats[b].pts - stats[a].pts || stats[b].gd - stats[a].gd);
        const tbody = document.querySelector("#leagueTable tbody");
        tbody.innerHTML = "";
        sorted.forEach((t, i) => {
            tbody.innerHTML += `<tr class="${i===0?'rank-1':''}"><td>${i+1}</td><td>${t}</td><td>${stats[t].p}</td><td>${stats[t].pts}</td><td>${stats[t].gd}</td></tr>`;
        });

        const mList = document.getElementById("matchesList");
        mList.innerHTML = "";
        data.leagueMatches.forEach((m, i) => { mList.innerHTML += createMatchHTML(m, i, 'L', data.isFinished); });

        const playoffDiv = document.getElementById("playoffs");
        const champAnnounce = document.getElementById("championAnnounce");

        if (played === 6) {
            playoffDiv.classList.remove("hidden");
            if (!data.semiFinal.h) { data.semiFinal.h = sorted[1]; data.semiFinal.a = sorted[2]; }
            document.getElementById("semiMatch").innerHTML = `<b>âš¡ Ù†ØµÙ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</b>` + createMatchHTML(data.semiFinal, 0, 'S', data.isFinished);
            
            if (data.semiFinal.sh !== null) {
                const winnerS = data.semiFinal.sh > data.semiFinal.sa ? data.semiFinal.h : data.semiFinal.a;
                if (!data.final.h) { data.final.h = sorted[0]; data.final.a = winnerS; }
                document.getElementById("finalMatch").innerHTML = `<b>ğŸ”¥ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</b>` + createMatchHTML(data.final, 0, 'F', data.isFinished);
                
                if (data.isFinished) {
                    champAnnounce.classList.remove("hidden");
                    document.getElementById("winnerName").innerText = data.winner;
                    if (viewingSeasonId == currentSeasonId) document.getElementById("newSeasonBtn").style.display = "block";
                } else {
                    champAnnounce.classList.add("hidden");
                }
            }
        } else {
            playoffDiv.classList.add("hidden");
            champAnnounce.classList.add("hidden");
        }
    }

    function createMatchHTML(m, i, type, disabled) {
        const isDis = disabled ? 'disabled' : '';
        return `
            <div class="match-card">
                <span style="width:70px; font-weight:bold;">${m.h}</span>
                <input type="number" id="${type}-h-${i}" class="score-input" value="${m.sh??''}" ${isDis}>
                <span style="color:#bdc3c7">vs</span>
                <input type="number" id="${type}-a-${i}" class="score-input" value="${m.sa??''}" ${isDis}>
                <span style="width:70px; font-weight:bold;">${m.a}</span>
                ${!disabled ? `<button class="btn btn-success" onclick="updateMatch('${type}', ${i})">âœ“</button>` : `<span class="badge">${m.time}</span>`}
            </div>
        `;
    }

    function createNewSeason() {
        currentSeasonId++;
        seasonsData[currentSeasonId] = createNewSeasonObject(currentSeasonId);
        document.getElementById("newSeasonBtn").style.display = "none";
        loadSeason(currentSeasonId);
    }

    init();
</script>
</body>
</html>
