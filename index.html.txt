<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø«Ù„Ø§Ø«Ø© - Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #3b82f6; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Tajawal', sans-serif; margin: 0; padding: 15px; text-align: center; }
        .card { background: var(--card); border-radius: 16px; padding: 15px; margin-bottom: 15px; border: 1px solid #334155; }
        .match-row { display: flex; align-items: center; justify-content: space-around; background: #0f172a; padding: 10px; border-radius: 12px; margin-bottom: 10px; }
        .score-input { width: 50px; height: 45px; text-align: center; background: #1e293b; color: white; border: 2px solid #3b82f6; border-radius: 8px; font-size: 1.2rem; }
        .btn-save { background: #10b981; color: white; border: none; padding: 8px 15px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; border-bottom: 1px solid #334155; }
        .pts { color: var(--primary); font-weight: 900; }
    </style>
</head>
<body>

    <h2>ğŸ† Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø«Ù„Ø§Ø«Ø©</h2>

    <div class="card">
        <h3>ğŸ“Š Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h3>
        <table id="leagueTable">
            <thead><tr><th>Ø§Ù„ÙØ±ÙŠÙ‚</th><th>Ù„Ø¹Ø¨</th><th>+/-</th><th>Ù†Ù‚Ø§Ø·</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div class="card">
        <h3>âš½ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
        <div id="matchesArea"></div>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyA_s2HoKKxwXELNHEmti_RsvA_nP6fmWP8",
        databaseURL: "https://nhffbjhh-default-rtdb.firebaseio.com",
        projectId: "nhffbjhh",
        appId: "1:779073349880:web:9cd7adb0ed3c628546b30d"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref('league_data');

    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    const players = ["Ø£Ø­Ù…Ø¯", "Ù…Ø´Ø¹Ù„", "ÙÙŠØµÙ„"];
    const initialMatches = [
        {h: "Ø£Ø­Ù…Ø¯", a: "Ù…Ø´Ø¹Ù„", sh: "", sa: ""}, {h: "Ù…Ø´Ø¹Ù„", a: "ÙÙŠØµÙ„", sh: "", sa: ""},
        {h: "ÙÙŠØµÙ„", a: "Ø£Ø­Ù…Ø¯", sh: "", sa: ""}, {h: "Ù…Ø´Ø¹Ù„", a: "Ø£Ø­Ù…Ø¯", sh: "", sa: ""},
        {h: "ÙÙŠØµÙ„", a: "Ù…Ø´Ø¹Ù„", sh: "", sa: ""}, {h: "Ø£Ø­Ù…Ø¯", a: "ÙÙŠØµÙ„", sh: "", sa: ""}
    ];

    db.on('value', (snap) => {
        const data = snap.val();
        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ÙØ§Ø±ØºØ©ØŒ Ù†Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙˆØ±Ø§Ù‹
        if (!data) {
            db.set({ matches: initialMatches });
            return;
        }
        render(data);
    });

    function render(data) {
        let stats = {"Ø£Ø­Ù…Ø¯":{p:0,pts:0,gd:0}, "Ù…Ø´Ø¹Ù„":{p:0,pts:0,gd:0}, "ÙÙŠØµÙ„":{p:0,pts:0,gd:0}};
        let html = "";

        data.matches.forEach((m, i) => {
            if(m.sh !== "" && m.sa !== "") {
                let hS = parseInt(m.sh), aS = parseInt(m.sa);
                stats[m.h].p++; stats[m.a].p++;
                stats[m.h].gd += (hS - aS); stats[m.a].gd += (aS - hS);
                if(hS > aS) stats[m.h].pts += 3; else if(aS > hS) stats[m.a].pts += 3; else {stats[m.h].pts++; stats[m.a].pts++;}
            }
            html += `<div class="match-row">
                <span>${m.h}</span>
                <input type="number" id="h${i}" value="${m.sh}" class="score-input">
                <span>:</span>
                <input type="number" id="a${i}" value="${m.sa}" class="score-input">
                <span>${m.a}</span>
                <button class="btn-save" onclick="save(${i})">Ø­ÙØ¸</button>
            </div>`;
        });
        document.getElementById('matchesArea').innerHTML = html;

        const sorted = players.sort((a,b) => stats[b].pts - stats[a].pts || stats[b].gd - stats[a].gd);
        document.querySelector("#leagueTable tbody").innerHTML = sorted.map(name => `
            <tr><td>${name}</td><td>${stats[name].p}</td><td>${stats[name].gd}</td><td class="pts">${stats[name].pts}</td></tr>
        `).join("");
    }

    function save(i) {
        const sh = document.getElementById(`h${i}`).value;
        const sa = document.getElementById(`a${i}`).value;
        db.child('matches').child(i).update({ sh, sa });
    }
</script>
</body>
</html>
